#include "oled096.h"

uint8_t ascii8x16[95][16]={
    //ascii code = index + 32
    {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
     0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},// 0
    
    {0x00,0x00,0x00,0xF8,0x00,0x00,0x00,0x00,
     0x00,0x00,0x00,0x33,0x00,0x00,0x00,0x00},//!1
    
    {0x00,0x10,0x0C,0x02,0x10,0x0C,0x02,0x00,
     0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},//"2
    
    {0x00,0x40,0xC0,0x78,0x40,0xC0,0x78,0x00,
     0x00,0x04,0x3F,0x04,0x04,0x3F,0x04,0x00},//#3
    
    {0x00,0x70,0x88,0x88,0xFC,0x08,0x30,0x00,
     0x00,0x18,0x20,0x20,0xFF,0x21,0x1E,0x00},//$4
    
    {0xF0,0x08,0xF0,0x80,0x60,0x18,0x00,0x00,
     0x00,0x31,0x0C,0x03,0x1E,0x21,0x1E,0x00},//%5
    
    {0x00,0xF0,0x08,0x88,0x70,0x00,0x00,0x00,
     0x1E,0x21,0x23,0x2C,0x19,0x27,0x21,0x10},//&6
    
    {0x00,0x12,0x0E,0x00,0x00,0x00,0x00,0x00,
     0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},//'7
    
    {0x00,0x00,0x00,0xE0,0x18,0x04,0x02,0x00,
     0x00,0x00,0x00,0x07,0x18,0x20,0x40,0x00},//(8
    
    {0x00,0x02,0x04,0x18,0xE0,0x00,0x00,0x00,
     0x00,0x40,0x20,0x18,0x07,0x00,0x00,0x00},//)9
    
    {0x40,0x40,0x80,0xF0,0x80,0x40,0x40,0x00,
     0x02,0x02,0x01,0x0F,0x01,0x02,0x02,0x00},//*10
    
    {0x00,0x00,0x00,0x00,0xE0,0x00,0x00,0x00,
     0x00,0x01,0x01,0x01,0x0F,0x01,0x01,0x01},//+11
    
    {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
     0x00,0x90,0x70,0x00,0x00,0x00,0x00,0x00},//,12
    
    {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
     0x00,0x01,0x01,0x01,0x01,0x01,0x01,0x00},//-13
    
    {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
     0x00,0x30,0x30,0x00,0x00,0x00,0x00,0x00},//.14
    
    {0x00,0x00,0x00,0x00,0xC0,0x38,0x04,0x00,
     0x00,0x60,0x18,0x07,0x00,0x00,0x00,0x00},///15
    
    {0x00,0xE0,0x10,0x08,0x08,0x10,0xE0,0x00,
     0x00,0x0F,0x10,0x20,0x20,0x10,0x0F,0x00},//016
    
    {0x00,0x00,0x10,0x10,0xF8,0x00,0x00,0x00,
     0x00,0x00,0x20,0x20,0x3F,0x20,0x20,0x00},//117
    
    {0x00,0x70,0x08,0x08,0x08,0x08,0xF0,0x00,
     0x00,0x30,0x28,0x24,0x22,0x21,0x30,0x00},//218
    
    {0x00,0x30,0x08,0x08,0x08,0x88,0x70,0x00,
     0x00,0x18,0x20,0x21,0x21,0x22,0x1C,0x00},//319
    
    {0x00,0x00,0x80,0x40,0x30,0xF8,0x00,0x00,
     0x00,0x06,0x05,0x24,0x24,0x3F,0x24,0x24},//420
    
    {0x00,0xF8,0x88,0x88,0x88,0x08,0x08,0x00,
     0x00,0x19,0x20,0x20,0x20,0x11,0x0E,0x00},//521
    
    {0x00,0xE0,0x10,0x88,0x88,0x90,0x00,0x00,
     0x00,0x0F,0x11,0x20,0x20,0x20,0x1F,0x00},//622
    
    {0x00,0x18,0x08,0x08,0x88,0x68,0x18,0x00,
     0x00,0x00,0x00,0x3E,0x01,0x00,0x00,0x00},//723
    
    {0x00,0x70,0x88,0x08,0x08,0x88,0x70,0x00,
     0x00,0x1C,0x22,0x21,0x21,0x22,0x1C,0x00},//824
    
    {0x00,0xF0,0x08,0x08,0x08,0x10,0xE0,0x00,
     0x00,0x01,0x12,0x22,0x22,0x11,0x0F,0x00},//925
    
    {0x00,0x00,0x00,0xC0,0xC0,0x00,0x00,0x00,
     0x00,0x00,0x00,0x30,0x30,0x00,0x00,0x00},//:26
    
    {0x00,0x00,0x00,0x80,0x00,0x00,0x00,0x00,
     0x00,0x00,0x00,0xE0,0x00,0x00,0x00,0x00},//;27
    
    {0x00,0x00,0x80,0x40,0x20,0x10,0x08,0x00,
     0x00,0x01,0x02,0x04,0x08,0x10,0x20,0x00},//<28
    
    {0x00,0x40,0x40,0x40,0x40,0x40,0x40,0x00,
     0x00,0x02,0x02,0x02,0x02,0x02,0x02,0x00},//=29
    
    {0x00,0x08,0x10,0x20,0x40,0x80,0x00,0x00,
     0x00,0x20,0x10,0x08,0x04,0x02,0x01,0x00},//>30
    
    {0x00,0x70,0x48,0x08,0x08,0x88,0x70,0x00,
     0x00,0x00,0x00,0x30,0x37,0x00,0x00,0x00},//?31
    
    {0xC0,0x30,0xC8,0x28,0xE8,0x10,0xE0,0x00,
     0x07,0x18,0x27,0x28,0x2F,0x28,0x17,0x00},//@32
    
    {0x00,0x00,0xC0,0x38,0xE0,0x00,0x00,0x00,
     0x20,0x3C,0x23,0x02,0x02,0x27,0x38,0x20},//A33
    
    {0x08,0xF8,0x88,0x88,0x88,0x70,0x00,0x00,
     0x20,0x3F,0x20,0x20,0x20,0x11,0x0E,0x00},//B34
    
    {0xC0,0x30,0x08,0x08,0x08,0x08,0x38,0x00,
     0x07,0x18,0x20,0x20,0x20,0x10,0x08,0x00},//C35
    
    {0x08,0xF8,0x08,0x08,0x08,0x10,0xE0,0x00,
     0x20,0x3F,0x20,0x20,0x20,0x10,0x0F,0x00},//D36
    
    {0x08,0xF8,0x88,0x88,0xE8,0x08,0x10,0x00,
     0x20,0x3F,0x20,0x20,0x23,0x20,0x18,0x00},//E37
    
    {0x08,0xF8,0x88,0x88,0xE8,0x08,0x10,0x00,
     0x20,0x3F,0x20,0x00,0x03,0x00,0x00,0x00},//F38
    
    {0xC0,0x30,0x08,0x08,0x08,0x38,0x00,0x00,
     0x07,0x18,0x20,0x20,0x22,0x1E,0x02,0x00},//G39
    
    {0x08,0xF8,0x08,0x00,0x00,0x08,0xF8,0x08,
     0x20,0x3F,0x21,0x01,0x01,0x21,0x3F,0x20},//H40
    
    {0x00,0x08,0x08,0xF8,0x08,0x08,0x00,0x00,
     0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00},//I41
    
    {0x00,0x00,0x08,0x08,0xF8,0x08,0x08,0x00,
     0xC0,0x80,0x80,0x80,0x7F,0x00,0x00,0x00},//J42
    
    {0x08,0xF8,0x88,0xC0,0x28,0x18,0x08,0x00,
     0x20,0x3F,0x20,0x01,0x26,0x38,0x20,0x00},//K43
    
    {0x08,0xF8,0x08,0x00,0x00,0x00,0x00,0x00,
     0x20,0x3F,0x20,0x20,0x20,0x20,0x30,0x00},//L44
    
    {0x08,0xF8,0xF8,0x00,0xF8,0xF8,0x08,0x00,
     0x20,0x3F,0x01,0x3E,0x01,0x3F,0x20,0x00},//M45
    
    {0x08,0xF8,0x30,0xC0,0x00,0x08,0xF8,0x08,
     0x20,0x3F,0x20,0x00,0x07,0x18,0x3F,0x00},//N46
    
    {0xE0,0x10,0x08,0x08,0x08,0x10,0xE0,0x00,
     0x0F,0x10,0x20,0x20,0x20,0x10,0x0F,0x00},//O47
    
    {0x08,0xF8,0x08,0x08,0x08,0x08,0xF0,0x00,
     0x20,0x3F,0x21,0x01,0x01,0x01,0x00,0x00},//P48
    
    {0xE0,0x10,0x08,0x08,0x08,0x10,0xE0,0x00,
     0x0F,0x10,0x28,0x28,0x30,0x50,0x4F,0x00},//Q49
    
    {0x08,0xF8,0x88,0x88,0x88,0x88,0x70,0x00,
     0x20,0x3F,0x20,0x00,0x03,0x0C,0x30,0x20},//R50
    
    {0x00,0x70,0x88,0x08,0x08,0x08,0x38,0x00,
     0x00,0x38,0x20,0x21,0x21,0x22,0x1C,0x00},//S51
    
    {0x18,0x08,0x08,0xF8,0x08,0x08,0x18,0x00,
     0x00,0x00,0x20,0x3F,0x20,0x00,0x00,0x00},//T52
    
    {0x08,0xF8,0x08,0x00,0x00,0x08,0xF8,0x08,
     0x00,0x1F,0x20,0x20,0x20,0x20,0x1F,0x00},//U53
    
    {0x08,0x78,0x88,0x00,0x00,0xC8,0x38,0x08,
     0x00,0x00,0x07,0x38,0x0E,0x01,0x00,0x00},//V54
    
    {0x08,0xF8,0x00,0xF8,0x00,0xF8,0x08,0x00,
     0x00,0x03,0x3E,0x01,0x3E,0x03,0x00,0x00},//W55
    
    {0x08,0x18,0x68,0x80,0x80,0x68,0x18,0x08,
     0x20,0x30,0x2C,0x03,0x03,0x2C,0x30,0x20},//X56
    
    {0x08,0x38,0xC8,0x00,0xC8,0x38,0x08,0x00,
     0x00,0x00,0x20,0x3F,0x20,0x00,0x00,0x00},//Y57
    
    {0x10,0x08,0x08,0x08,0xC8,0x38,0x08,0x00,
     0x20,0x38,0x26,0x21,0x20,0x20,0x18,0x00},//Z58
    
    {0x00,0x00,0x00,0xFE,0x02,0x02,0x02,0x00,
     0x00,0x00,0x00,0x7F,0x40,0x40,0x40,0x00},//[59
    
    {0x00,0x04,0x38,0xC0,0x00,0x00,0x00,0x00,
     0x00,0x00,0x00,0x01,0x06,0x38,0xC0,0x00},//\60
    
    {0x00,0x02,0x02,0x02,0xFE,0x00,0x00,0x00,
     0x00,0x40,0x40,0x40,0x7F,0x00,0x00,0x00},//]61
    
    {0x00,0x00,0x04,0x02,0x02,0x04,0x00,0x00,
     0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},//^62
    
    {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
     0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80},//_63
    
    {0x00,0x02,0x02,0x04,0x00,0x00,0x00,0x00,
     0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00},//`64
    
    {0x00,0x00,0x80,0x80,0x80,0x00,0x00,0x00,
     0x00,0x19,0x24,0x24,0x12,0x3F,0x20,0x00},//a65
    
    {0x10,0xF0,0x00,0x80,0x80,0x00,0x00,0x00,
     0x00,0x3F,0x11,0x20,0x20,0x11,0x0E,0x00},//b66
    
    {0x00,0x00,0x00,0x80,0x80,0x80,0x00,0x00,
     0x00,0x0E,0x11,0x20,0x20,0x20,0x11,0x00},//c67
    
    {0x00,0x00,0x80,0x80,0x80,0x90,0xF0,0x00,
     0x00,0x1F,0x20,0x20,0x20,0x10,0x3F,0x20},//d68
    
    {0x00,0x00,0x80,0x80,0x80,0x80,0x00,0x00,
     0x00,0x1F,0x24,0x24,0x24,0x24,0x17,0x00},//e69
    
    {0x00,0x80,0x80,0xE0,0x90,0x90,0x20,0x00,
     0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00},//f70
    
    {0x00,0x00,0x80,0x80,0x80,0x80,0x80,0x00,
     0x00,0x6B,0x94,0x94,0x94,0x93,0x60,0x00},//g71
    
    {0x10,0xF0,0x00,0x80,0x80,0x80,0x00,0x00,
     0x20,0x3F,0x21,0x00,0x00,0x20,0x3F,0x20},//h72
    
    {0x00,0x80,0x98,0x98,0x00,0x00,0x00,0x00,
     0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00},//i73
    
    {0x00,0x00,0x00,0x80,0x98,0x98,0x00,0x00,
     0x00,0xC0,0x80,0x80,0x80,0x7F,0x00,0x00},//j74
    
    {0x10,0xF0,0x00,0x00,0x80,0x80,0x80,0x00,
     0x20,0x3F,0x24,0x06,0x29,0x30,0x20,0x00},//k75
    
    {0x00,0x10,0x10,0xF8,0x00,0x00,0x00,0x00,
     0x00,0x20,0x20,0x3F,0x20,0x20,0x00,0x00},//l76
    
    {0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x00,
     0x20,0x3F,0x20,0x00,0x3F,0x20,0x00,0x3F},//m77
    
    {0x80,0x80,0x00,0x80,0x80,0x80,0x00,0x00,
     0x20,0x3F,0x21,0x00,0x00,0x20,0x3F,0x20},//n78
    
    {0x00,0x00,0x80,0x80,0x80,0x80,0x00,0x00,
     0x00,0x1F,0x20,0x20,0x20,0x20,0x1F,0x00},//o79
    
    {0x80,0x80,0x00,0x80,0x80,0x00,0x00,0x00,
     0x80,0xFF,0x91,0x20,0x20,0x11,0x0E,0x00},//p80
    
    {0x00,0x00,0x00,0x80,0x80,0x00,0x80,0x00,
     0x00,0x0E,0x11,0x20,0x20,0x91,0xFF,0x80},//q81
    
    {0x80,0x80,0x80,0x00,0x80,0x80,0x80,0x00,
     0x20,0x20,0x3F,0x21,0x20,0x00,0x01,0x00},//r82
    
    {0x00,0x00,0x80,0x80,0x80,0x80,0x80,0x00,
     0x00,0x33,0x24,0x24,0x24,0x24,0x19,0x00},//s83
    
    {0x00,0x80,0x80,0xE0,0x80,0x80,0x00,0x00,
     0x00,0x00,0x00,0x1F,0x20,0x20,0x10,0x00},//t84
    
    {0x80,0x80,0x00,0x00,0x00,0x80,0x80,0x00,
     0x00,0x1F,0x20,0x20,0x20,0x10,0x3F,0x20},//u85
    
    {0x80,0x80,0x80,0x00,0x80,0x80,0x80,0x00,
     0x00,0x03,0x0C,0x30,0x0C,0x03,0x00,0x00},//v86
    
    {0x80,0x80,0x00,0x80,0x80,0x00,0x80,0x80,
     0x01,0x0E,0x30,0x0C,0x07,0x38,0x06,0x01},//w87
    
    {0x00,0x80,0x80,0x80,0x00,0x80,0x80,0x00,
     0x00,0x20,0x31,0x0E,0x2E,0x31,0x20,0x00},//x88
    
    {0x80,0x80,0x80,0x00,0x00,0x80,0x80,0x80,
     0x00,0x81,0x86,0x78,0x18,0x06,0x01,0x00},//y89
    
    {0x00,0x80,0x80,0x80,0x80,0x80,0x80,0x00,
     0x00,0x21,0x30,0x2C,0x22,0x21,0x30,0x00},//z90
    
    {0x00,0x00,0x00,0x00,0x00,0xFC,0x02,0x02,
     0x00,0x00,0x00,0x00,0x01,0x3E,0x40,0x40},//{91
    
    {0x00,0x00,0x00,0x00,0xFF,0x00,0x00,0x00,
     0x00,0x00,0x00,0x00,0xFF,0x00,0x00,0x00},//|92
    
    {0x02,0x02,0xFC,0x00,0x00,0x00,0x00,0x00,
     0x40,0x40,0x3E,0x01,0x00,0x00,0x00,0x00},//}93
    
    {0x00,0x02,0x01,0x02,0x02,0x04,0x02,0x00,
     0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}//~94
};

//private functions

void OLED096_pinCtrl(OLED096_Pin pin, uint8_t status){ //BSP Function
    BitAction action = Bit_SET;
    if(status == 0){
        action = Bit_RESET;
    }
    if(pin == OLED096_Pin_DC){
        GPIO_WriteBit(GPIOB, GPIO_Pin_9, action);
    }
    else if(pin == OLED096_Pin_RST){
        GPIO_WriteBit(GPIOB, GPIO_Pin_8, action);
    }
    else if(pin == OLED096_Pin_NSS){
        GPIO_WriteBit(GPIOA, GPIO_Pin_4, action);
    }
}

void OLED096_hwInit(){ //BSP Function
    RCC_APB2PeriphClockCmd(RCC_APB2Periph_SPI1, ENABLE);
    RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOA, ENABLE);
    RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOB, ENABLE);
    
    GPIO_InitTypeDef GPIO_InitStructure;
    GPIO_InitStructure.GPIO_Pin = GPIO_Pin_5 | GPIO_Pin_7;
    GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF_PP;
    GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
    GPIO_Init(GPIOA, &GPIO_InitStructure);
    GPIO_InitStructure.GPIO_Pin = GPIO_Pin_6;
    GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IN_FLOATING;
    GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
    GPIO_Init(GPIOA, &GPIO_InitStructure);
    GPIO_InitStructure.GPIO_Pin = GPIO_Pin_4;
    GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP;
    GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
    GPIO_Init(GPIOA, &GPIO_InitStructure);
    GPIO_InitStructure.GPIO_Pin = GPIO_Pin_8 | GPIO_Pin_9;
    GPIO_InitStructure.GPIO_Mode = GPIO_Mode_Out_PP;
    GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
    GPIO_Init(GPIOB, &GPIO_InitStructure);
    
    SPI_InitTypeDef SPI_InitStructure;
    SPI_InitStructure.SPI_BaudRatePrescaler = SPI_BaudRatePrescaler_16;
    SPI_InitStructure.SPI_CPHA = SPI_CPHA_1Edge;
    SPI_InitStructure.SPI_CPOL = SPI_CPOL_Low;
    SPI_InitStructure.SPI_CRCPolynomial = 7;
    SPI_InitStructure.SPI_DataSize = SPI_DataSize_8b;
    SPI_InitStructure.SPI_Direction = SPI_Direction_2Lines_FullDuplex;
    SPI_InitStructure.SPI_FirstBit = SPI_FirstBit_MSB;
    SPI_InitStructure.SPI_Mode = SPI_Mode_Master;
    SPI_InitStructure.SPI_NSS = SPI_NSS_Soft;
    SPI_Init(SPI1, &SPI_InitStructure);
    SPI_Cmd(SPI1, ENABLE);
}

uint8_t OLED096_SPIWriteReadByte(uint8_t txData){ //BSP Function
    uint8_t retry = 0;
    while(SPI_I2S_GetFlagStatus(SPI1, SPI_I2S_FLAG_TXE) == RESET){
        retry++;
        if(retry > 200){
            return 0;
        }
    }
    SPI_I2S_SendData(SPI1, txData);
    retry = 0;
    while(SPI_I2S_GetFlagStatus(SPI1, SPI_I2S_FLAG_RXNE) == RESET){
        retry++;
        if(retry > 200){
            return 0;
        }
    }
    return SPI_I2S_ReceiveData(SPI1);
}

void OLED096_writeByte(uint8_t data, OLED096_WriteAction action){
    if(action == OLED096_WriteAction_Cmd){
        OLED096_pinCtrl(OLED096_Pin_DC, 0);
    }
    else if(action == OLED096_WriteAction_Data){
        OLED096_pinCtrl(OLED096_Pin_DC, 1);
    }
    OLED096_pinCtrl(OLED096_Pin_NSS, 0);
    OLED096_SPIWriteReadByte(data);
    OLED096_pinCtrl(OLED096_Pin_NSS, 1);
}

//public functions

void OLED096_init(){
    delay_init();
    OLED096_hwInit();
    OLED096_reset();
}

void OLED096_reset(){
    OLED096_pinCtrl(OLED096_Pin_DC, 1);
    OLED096_pinCtrl(OLED096_Pin_NSS, 1);
    OLED096_pinCtrl(OLED096_Pin_RST, 1);
    delay_us(20);
    
    OLED096_pinCtrl(OLED096_Pin_RST, 0);
    delay_us(20);
    OLED096_pinCtrl(OLED096_Pin_RST, 1);
    delay_us(20);
    
    /* Screen Configuration */
    //Set Display ON/OFF:off
    OLED096_writeByte(0xAE,OLED096_WriteAction_Cmd);
    //Set Memory Addressing Mode:Page Addressing Mode
    OLED096_writeByte(0x20,OLED096_WriteAction_Cmd);
	OLED096_writeByte(0x10,OLED096_WriteAction_Cmd);
    //Set Page Start Address for Page Addressing Mode:0(for setting current address)  
    OLED096_writeByte(0xB0,OLED096_WriteAction_Cmd);
    //Set Lower Column Start Address for Page Addressing Mode:0(for setting current address)
    OLED096_writeByte(0x00,OLED096_WriteAction_Cmd); 
    //Set Higher Column Start Address for Page Addressing Mode:0(for setting current address)
    OLED096_writeByte(0x10,OLED096_WriteAction_Cmd);
    //Set COM Output Scan Direction:remapped mode(for re-mapping)
	OLED096_writeByte(0xC8,OLED096_WriteAction_Cmd);
    //Set Segment Re-map:Column address 0 is mapped to SEG0(for re-mapping)
    OLED096_writeByte(0xA1,OLED096_WriteAction_Cmd);
    //Set Display Start Line:40h
    OLED096_writeByte(0x40,OLED096_WriteAction_Cmd);
    //Set Display Offset:0
    OLED096_writeByte(0xD3,OLED096_WriteAction_Cmd);
	OLED096_writeByte(0x00,OLED096_WriteAction_Cmd);
    //Set Normal/Inverse Display:Normal Display
	OLED096_writeByte(0xA6,OLED096_WriteAction_Cmd);
    //Set multiplex ratio:64
    OLED096_writeByte(0xA8,OLED096_WriteAction_Cmd);
    OLED096_writeByte(0x3F,OLED096_WriteAction_Cmd);
    //Entire Display ON:Resume to RAM content display 
	OLED096_writeByte(0xA4,OLED096_WriteAction_Cmd);
    //Set Display Clock Divide Ratio/Oscillator Frequency:Highest Frequency and no division
	OLED096_writeByte(0xD5,OLED096_WriteAction_Cmd);
	OLED096_writeByte(0xF0,OLED096_WriteAction_Cmd);
    //Set Contrast Control:ffh
    OLED096_writeByte(0x81,OLED096_WriteAction_Cmd);
	OLED096_writeByte(0xFF,OLED096_WriteAction_Cmd);
    //Set Pre-charge Period
	OLED096_writeByte(0xD9,OLED096_WriteAction_Cmd); 
	OLED096_writeByte(0x22,OLED096_WriteAction_Cmd);
    //Set COM Pins Hardware Configuration:Default
	OLED096_writeByte(0xDA,OLED096_WriteAction_Cmd);
	OLED096_writeByte(0x12,OLED096_WriteAction_Cmd);
    //Set Vcomh Deselect Level:0.77Vcc,default
	OLED096_writeByte(0xDB,OLED096_WriteAction_Cmd);
	OLED096_writeByte(0x20,OLED096_WriteAction_Cmd);
    //Charge Bump:Enable
	OLED096_writeByte(0x8D,OLED096_WriteAction_Cmd);
	OLED096_writeByte(0x14,OLED096_WriteAction_Cmd);
    //Set Display ON/OFF:on
	OLED096_writeByte(0xAF,OLED096_WriteAction_Cmd);
    
    OLED096_clearScreen();
}

void OLED096_clearScreen(){
    uint8_t i, n;
    for(i = 0; i < 8; i++){
        OLED096_writeByte(0xB0 + i, OLED096_WriteAction_Cmd);
        OLED096_writeByte(0x00, OLED096_WriteAction_Cmd);
        OLED096_writeByte(0x10, OLED096_WriteAction_Cmd);
        for(n = 0; n < 128; n++){
            OLED096_writeByte(0x00, OLED096_WriteAction_Data); 
        }
    }
}

void OLED096_writeLine(uint8_t row, OLED096_Align align, uint8_t reverseColor, char* str){
    //Usage: row 0-3
    if(row > 3){
        return;
    }
    //clear row
    int16_t colIndex, i;
    for(i = 0; i < 2; i++){
        OLED096_writeByte(0xB0 + row * 2 + i, OLED096_WriteAction_Cmd);
        OLED096_writeByte(0x00, OLED096_WriteAction_Cmd);
        OLED096_writeByte(0x10, OLED096_WriteAction_Cmd);
        if(reverseColor == 0){
            for(colIndex = 0; colIndex < 128; colIndex++){
                OLED096_writeByte(0x00, OLED096_WriteAction_Data); 
            }
        }
        else{
            for(colIndex = 0; colIndex < 128; colIndex++){
                OLED096_writeByte(0xFF, OLED096_WriteAction_Data); 
            }
        }
    }
    //write row
    char* str1 = str;
    int16_t colStartIndex;
    uint8_t strLength = 0;
    while((*str1) != '\0'){
        str1++;
        strLength++;
    }
    if(align == OLED096_Align_Left){
        colStartIndex = 0;
    }
    else if(align == OLED096_Align_Center){
        colStartIndex = 64 - strLength * 4;
    }
    else if(align == OLED096_Align_Right){
        colStartIndex = 128 - strLength * 8;
    }
    for(i = 0; i < 2; i++){
        str1 = str;
        colIndex = colStartIndex;
        uint8_t start = 0;
        OLED096_writeByte(0xB0 + row * 2 + i, OLED096_WriteAction_Cmd);
        while((*str1) != '\0'){
            uint8_t j;
            for(j = 0; j < 8; j++){
                if(colIndex >= 0 && colIndex <=127){
                    if(start == 0){
                        OLED096_writeByte(0x00 + (((uint8_t)colIndex) & 0x0F), OLED096_WriteAction_Cmd);
                        OLED096_writeByte(0x10 + ((((uint8_t)colIndex) & 0xF0) >> 4), OLED096_WriteAction_Cmd); 
                        start = 1;
                    }
                    if(reverseColor == 0){
                        OLED096_writeByte(ascii8x16[(*str1) - 32][j + 8 * i], OLED096_WriteAction_Data);
                    }
                    else{
                        OLED096_writeByte(~(ascii8x16[(*str1) - 32][j + 8 * i]), OLED096_WriteAction_Data);
                    }
                }
                colIndex++;
            }
            str1++;
        }
    }
}

void OLED096_writeScreen(char* str){
    OLED096_clearScreen();
    char* str1;
    uint8_t i, j, k, m;
    uint8_t end;
    for(m = 0; m < 2; m++){
        str1 = str;
        end = 0;
        for(i = 0; i < 4; i++){
            OLED096_writeByte(0xB0 + i * 2 + m, OLED096_WriteAction_Cmd);
            OLED096_writeByte(0x00, OLED096_WriteAction_Cmd);
            OLED096_writeByte(0x10, OLED096_WriteAction_Cmd); 
            for(j = 0; j < 16; j++){
                if((*str1) != '\0'){
                    for(k = 0; k < 8; k++){
                        OLED096_writeByte(ascii8x16[(*str1) - 32][k + 8 * m], OLED096_WriteAction_Data); 
                    }
                    str1++;
                }
                else{
                    end = 1;
                    break;
                } 
            }
            if(end == 1){
                break;
            }
        }
    }
}

void OLED096_playTestAnimateOnce(){
    uint8_t i,n;		    
    for(i=0;i<8;i++)  
    {  
        OLED096_writeByte (0xb0+i,OLED096_WriteAction_Cmd);
        OLED096_writeByte (0x00,OLED096_WriteAction_Cmd);
        OLED096_writeByte (0x10,OLED096_WriteAction_Cmd);
        for(n=0;n<128;n++){
            OLED096_writeByte(0x00,OLED096_WriteAction_Data);
        }
    }
    delay_ms(200);
    for(i=0;i<8;i++)  
    {  
        OLED096_writeByte (0xb0+i,OLED096_WriteAction_Cmd);
        OLED096_writeByte (0x00,OLED096_WriteAction_Cmd);
        OLED096_writeByte (0x10,OLED096_WriteAction_Cmd);
        for(n=0;n<128;n++){
            OLED096_writeByte(0x01,OLED096_WriteAction_Data);
        }
    }
    delay_ms(200);
    for(i=0;i<8;i++)  
    {  
        OLED096_writeByte (0xb0+i,OLED096_WriteAction_Cmd);
        OLED096_writeByte (0x00,OLED096_WriteAction_Cmd);
        OLED096_writeByte (0x10,OLED096_WriteAction_Cmd);
        for(n=0;n<128;n++){
            OLED096_writeByte(0x03,OLED096_WriteAction_Data);
        }
    }
    delay_ms(200);
    for(i=0;i<8;i++)  
    {  
        OLED096_writeByte (0xb0+i,OLED096_WriteAction_Cmd);
        OLED096_writeByte (0x00,OLED096_WriteAction_Cmd);
        OLED096_writeByte (0x10,OLED096_WriteAction_Cmd);      
        for(n=0;n<128;n++){
            OLED096_writeByte(0x07,OLED096_WriteAction_Data);
        }
    }
    delay_ms(200);
    for(i=0;i<8;i++)  
    {  
        OLED096_writeByte (0xb0+i,OLED096_WriteAction_Cmd);
        OLED096_writeByte (0x00,OLED096_WriteAction_Cmd);
        OLED096_writeByte (0x10,OLED096_WriteAction_Cmd);      
        for(n=0;n<128;n++){
            OLED096_writeByte(0x0F,OLED096_WriteAction_Data);
        }
    }
    delay_ms(200);
    for(i=0;i<8;i++)  
    {  
        OLED096_writeByte (0xb0+i,OLED096_WriteAction_Cmd);
        OLED096_writeByte (0x00,OLED096_WriteAction_Cmd);
        OLED096_writeByte (0x10,OLED096_WriteAction_Cmd); 
        for(n=0;n<128;n++){
            OLED096_writeByte(0x1F,OLED096_WriteAction_Data);
        }
    }
    delay_ms(200);
    for(i=0;i<8;i++)  
    {  
        OLED096_writeByte (0xb0+i,OLED096_WriteAction_Cmd);
        OLED096_writeByte (0x00,OLED096_WriteAction_Cmd);
        OLED096_writeByte (0x10,OLED096_WriteAction_Cmd);
        for(n=0;n<128;n++){
            OLED096_writeByte(0x3F,OLED096_WriteAction_Data);
        }
    }
    delay_ms(200);
    for(i=0;i<8;i++)  
    {  
        OLED096_writeByte (0xb0+i,OLED096_WriteAction_Cmd);
        OLED096_writeByte (0x00,OLED096_WriteAction_Cmd);
        OLED096_writeByte (0x10,OLED096_WriteAction_Cmd); 
        for(n=0;n<128;n++){
            OLED096_writeByte(0x7F,OLED096_WriteAction_Data);
        }
    }
    delay_ms(200);
    for(i=0;i<8;i++)  
    {  
        OLED096_writeByte (0xb0+i,OLED096_WriteAction_Cmd);
        OLED096_writeByte (0x00,OLED096_WriteAction_Cmd);
        OLED096_writeByte (0x10,OLED096_WriteAction_Cmd);
        for(n=0;n<128;n++){
            OLED096_writeByte(0xFF,OLED096_WriteAction_Data);
        }
    }
    delay_ms(1000);
}

void OLED096_setContrast(uint8_t contrast){
    //Set Contrast Control:ffh
    OLED096_writeByte(0x81, OLED096_WriteAction_Cmd);
	OLED096_writeByte(contrast, OLED096_WriteAction_Cmd);
}
